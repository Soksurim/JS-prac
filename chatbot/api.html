<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no width=device-width" />
    <title>
        채팅 자동응답 봇 API 설명
    </title>
</head>
<body bgcolor=#FFFFFF style="margin:10px 10px 10px 10px;">
<div style="padding:10dp 10dp 10dp 10dp;">
    <font color=BLACK size='3px'>
	<b><big>이벤트 리스너</big></b>
	<ul>
	<li><b>function response(room, msg, sender, isGroupChat, replier, ImageDB, packageName)</b><br>
	 -> 채팅이 수신되면 호출되는 이벤트 리스너.
	 <center><table border=1 width=90%>
	 <tr>
	 <td align=center><b>room</b></td>
	 <td>채팅이 수신된 채팅방의 이름</td>
	 </tr>
	 <tr>
	 <td align=center><b>msg</b></td>
	 <td>수신된 채팅 내용</td>
	 </tr>
	 <tr>
	 <td align=center><b>sender</b></td>
	 <td>채팅을 보낸 사람의 닉네임</td>
	 </tr>
	 <tr>
	 <td align=center><b>isGroupChat</b></td>
	 <td>단체 채팅방인지 아닌지. 단체 채팅방이라면 true, 아니면 false.</td>
	 </tr>
	 <tr>
	 <td align=center><b>replier</b></td>
	 <td>세션 캐싱 답장 메소드 객체</td>
	 </tr>
	 <tr>
	 <td align=center><b>ImageDB</b></td>
	 <td>이미지 정보가 담겨 있는 객체</td>
	 </tr>
	 <tr>
	 <td align=center><b>packageName</b></td>
	 <td>채팅이 수신된 앱의 패키지명</td>
	 </tr>
	 </table></center>
	 
<b>replier</b><br>
  replier.reply(msg); - 채팅이 수신된 채팅방으로 답장 전송<br>
  replier.reply(room, msg); - 채팅이 수신된 앱의 해당 채팅방으로 답장 전송<br>
  replier.reply(room, msg, packageName); - 해당 패키지명을 가진 앱의 해당 채팅방으로 답장 전송<br>
  replier.markAsRead(); - 채팅의 수신된 채팅방에서 읽음처리<br>
  replier.markAsRead(room); - 채팅의 수신된 메신저 앱의 해당 채팅방에서 읽음처리<br>
  replier.markAsRead(room, packageName); - 해당 메신저 앱의 해당 채팅방에서 읽음처리<br>
<b>ImageDB</b><br>
  ImageDB.getImage(); - 사진이 수신된 경우, 그 사진을 Base64 인코딩된 상태로 가져옴. 불안정함.<br>
  ImageDB.getImageBitmap(); - 사진이 수신된 경우, 그 사진을 Bitmap으로 가져옴. 불안정함.<br>
  ImageDB.getProfileImage(); - 채팅을 보낸 사람의 프로필 사진을 Base64 인코딩된 상태로 가져옴. 안드로이드 7.0 이상부터 작동.<br>
  ImageDB.getProfileImageBitmap(); - 채팅을 보낸 사람의 프로필 사진을 Bitmap으로 가져옴. 안드로이드 7.0 이상부터 작동.<br>
  ImageDB.getProfileBitmap(); - ImageDB.getProfileImageBitmap();와 동일<br>
	 </li>
	 
	<li><b>function onLoaded(ctx)</b><br>
	 -> 리로드 버튼을 눌러서 스크립트가 리로드되면 수신되면 호출되는 이벤트 리스너.
	 <center><table border=1 width=90%>
	 <tr>
	 <td align=center><b>ctx</b></td>
	 <td>컨텍스</td>
	 </tr>
	 </table></center>
	</li>
	
	</ul>
  
  <b><big>전처리기 및 함수</big></b>
	<ul>
	<li>print(msg);<br>
	 -> 해당 내용을 토스트 메시지로 출력</li>
	<li>#include "파일명"<br>
	 -> 봇 소스 파일과 같은 경로에 있는 해당 파일의 내용을 리로드 직전에 봇 소스에 포함시킴</li>
	</ul>
	
	<b><big>Api</big></b>
	<ul>
	<li>Api.getContext();<br>
	  -> Context를 가져옴.</li>
	<li>Api.reload(name);<br>
	 -> 해당 이름을 가진 봇 리로드</li>
	<li>Api.compile(name);<br>
	 -> Api.reload(name);와 동일.</li>
	<li>Api.isOn(name);<br>
     -> 해당 이름을 가진 봇이 켜진 상태인지 확인</li>
	<li>Api.on(name);<br>
	 -> 해당 이름을 가진 채팅 자동응답 봇을 킴</li>
	<li>Api.off(name);<br>
	 -> 해당 이름을 가진 채팅 자동응답 봇을 끔</li>
	<li>Api.showToast(msg, leng);<br>
	 -> 화면에 토스트 출력</li>
	<li>Api.UiThread(func);<br>
	 -> UI 쓰레드에서 해당 함수 실행.</li>
	<li>Api.canReply(room, msg, packageName);<br>
	 -> 해당 채팅방으로 채팅을 전송할 수 있는지 확인. room은 방 이름, packageName은 채팅을 보낼 앱의 패키지명이고 생략시 가장 최근에 알림이 뜬 앱</li>
	<li>Api.replyRoom(room, msg, packageName);<br>
	 -> 해당 채팅방으로 채팅 전송. room은 방 이름, msg는 채팅 내용, packageName은 채팅을 보낼 앱의 패키지명이고 생략시 가장 최근에 알림이 뜬 앱</li>
	<li>Api.markAsRead(room, packageName);<br>
	 -> 채팅의 수신된 메신저 앱의 해당 채팅방에서 읽음처리. room은 방 이름, packageName은 읽음 처리를 할 앱의 패키지명이고 생략시 가장 최근에 알림이 뜬 앱</li>
	<li>Api.getScriptNames();<br>
	 -> 모든 봇 목록을 배열로 반환.</li>
	<li>Api.gc();<br>
	 -> 아마도 가비지 컬렉터 강제 실행.</li>
	<li>Api.papagoTranslate(lang1, lang2, value);<br>
	 -> value를 언어코드가 lang1인 해당하는 언어라고 가정하고 언어코드가 lang2인 언어로 번역.</li>
	<li>Api.papagoTranslate(lang1, lang2, value, clientId, clientSecret);<br>
	 -> Api.papagoTranslate(lang1, lang2, value);와 동일하나, 사용자가 개인적으로 발급받은 네이버 파파고 api의 clientId와 clientSecret 사용 가능.</li>
	</ul>
	
	<b><big>Bot</big></b>
	<ul>
	<li>Bot.send(room, msg, packageName);<br>
	 -> Api.replyRoom();과 동일</li>
	<li>Bot.getContext();<br>
	  -> Context를 가져옴.</li>
	<li>Bot.getVersion();<br>
	 -> 채팅 자동응답 봇의 버전을 가져옴.</li>
	<li>Bot.getJsVersion();<br>
     -> 현재 설정되어 있는 채팅 자동응답 봇 (JS)의 자바스크립트 버전을 가져옴.</li>
	<li>Bot.reload(name);<br>
	 -> Api.reload(name);와 동일.</li>
	<li>Bot.getName();<br>
	 -> 해당 봇의 이름을 가지고 옴.</li>
	<li>Bot.runOnUiThread(name, func);<br>
	 -> 해당 이름을 가진 채팅 자동응답 봇의 UI 쓰레드에서 실행.</li>
	<li>Bot.on(name);<br>
	 -> 해당 이름을 가진 채팅 자동응답 봇을 킴</li>
	<li>Bot.off(name);<br>
	 -> 해당 이름을 가진 채팅 자동응답 봇을 끔</li>
	</ul>
	
	<b><big>Utils</big></b>
	<ul>
	<li>Utils.toast(msg);<br>
	 -> 해당 내용을 토스트 메시지로 출력.</li>
	<li>Utils.getWebText(url, removeTags);<br>
	 -> Jsoup 라이브러리를 이용하여 해당 URL 크롤링.</li>
	<li>Utils.getWebText2(url, encoding);<br>
	 -> java.net 패키지를 이용하여 해당 URL 크롤링, 사이트 인코딩(?) 설정 가능.</li>
    <li>Utils.getHtmlFromWeb(url);<br>
	 -> java.net 패키지를 이용하여 해당 URL 크롤링. <b>Utils.getWebText(); 또는 Utils.getWebText2(); 사용 권장</b></li>
	<li>Utils.removeTags(str);<br>
	 -> 해당 문자열에서 HTML 태그 삭제.</li>
	<li>Utils.parse(url);<br>
	 -> Jsoup 라이브러리를 이용하여 해당 URL을 크롤링한 내용을 org.jsoup.nodes.Document 형태로 반환</li>
	<li>Utils.copyToClipboard(value);<br>
	 -> 해당 내용을 클립보드로 복사함.</li>
	<li>Utils.compress();<br>
	 -> 투명문자 1000개 반환. 보낼 채팅 내용 같은거 사이에 적당히 잘 끼워넣으면, 전체보기로 만들기 가능.</li>
	<li>Utils.vibrate(sec);<br>
	 -> sec초 동안 진동.</li>
	<li>Utils.delay(mil);<br>
	 -> mil 밀리초동안 딜레이.</li>
	<li>Utils.sleep(mil);<br>
	 -> Utils.delay();와 동일.</li>
	</ul>
	
	<b><big>File</big></b>&nbsp;<s>FileStream 사용 권장</s>
	<ul>
	<li>File.getSdcardPath();<br>
	 -> 내장메모리 최상위 경로(?)를 가져옴</li>
	<li>File.save(path, value);<br>
	 -> 해당 경로에 해당 내용을 가진 파일 저장. 이미 파일이 있는 경우 내용 덮어쓰기.</li>
	<li>File.save(path, value, isAppend);<br>
	 -> 해당 경로에 해당 내용을 가진 파일 저장. isAppend가 true라면 기존에 있던 내용 뒤에 붙이고, false라면 덮어쓰기.</li>
	<li>File.read(path);<br>
	 -> 해당 경로에 있는 파일의 내용을 읽어옴.</li>
	<li>File.remove(path);<br>
	 -> 해당 경로에 있는 파일 삭제.</li>
	<li>File.createFolder(path);<br>
	 -> 해당 경로를 가지는(?) 폴더 생성.</li>
	</ul>
	
	<b><big>FileStream</big></b>
	<ul>
	<li>FileStream.getSdcardPath();<br>
	 -> 내장메모리 최상위 경로(?)를 가져옴</li>
	<li>FileStream.write(path, value);<br>
	 -> 해당 경로에 해당 내용을 가진 파일 저장. 이미 파일이 있는 경우 내용 덮어쓰기.</li>
	<li>FileStream.append(path, value);<br>
	 -> 해당 경로에 있는 파일 뒤에 해당 내용을 붙여서 저장(?).</li>
	<li>FileStream.save(path, value, isAppend);<br>
	 -> 해당 경로에 해당 내용을 가진 파일 저장. isAppend가 true라면 기존에 있던 내용 뒤에 붙이고, false라면 덮어쓰기.</li>
	<li>FileStream.remove(path);<br>
	 -> 해당 경로에 있는 파일 삭제. 삭제 성공시 true, 실패시 false 반환</li>
	<li>FileStream.createDir(path);<br>
	 -> 해당 경로를 가지는(?) 폴더 생성.</li>
	<li>FileStream.saveJson(path, json);<br>
	 -> 해당 경로에 해당 json을 문자열로 바꾸어서 저장.</li>
	<li>FileStream.readJson(path);<br>
	 -> 해당 경로에 있는 문자열로 저장된 json을 읽어옴.</li>
	</ul>
	
	<b><big>Device</big></b>
	<ul>
	<li>Device.getModelName();<br>
	 -> 기기 모델명 반환.</li>
	<li>Device.getPhoneModel();<br>
	 -> Device.getModelName();와 동일.</li>
	<li>Device.getPhoneBrand();<br>
	 -> 기기 제조사 반환.</li>
	<li>Device.getAndroidVersion();<br>
	 -> 안드로이드 버전 반환.</li>
	<li>Device.getAndroidVersionName();<br>
	 -> Device.getApiLevel();와 동일.</li>
	<li>Device.getApiLevel();<br>
	 -> 안드로이드 API 레벨 반환.</li>
	<li>Device.getAndroidVersionCode();<br>
	 -> Device.getApiLevel();와 동일.</li>
	<li>Device.getBuild();<br>
	 -> android.os.Build();값 반환.</li>
	<li>Device.getBatteryIntent();<br>
	 -> 배터리 관련 Intent 반환.</li>
	<li>Device.getBatteryLevel();<br>
	 -> 배터리 잔량 반환. 단위는 %.</li>
	<li>Device.getBatteryTemp();<br>
	 -> 배터리 온도 반환. 단위는 ℃.</li>
	<li>Device.getBatteryHealth();<br>
	 -> 배터리 건강 상태(?) 반환.</li>
	<li>Device.getBatteryStatus();<br>
	 -> 배터리 상태 반환.</li>
	<li>Device.getBatteryVoltage();<br>
	 -> 배터리 전압 반환.</li>
	<li>Device.isCharging();<br>
	 -> 배터리가 충전중인지 반환.</li>
	</ul>
	
	<b><big>Log</big></b>
	<ul>
	<li>Log.info(log, isGlobal);<br>
	 -> 로깅. isGlobal가 참이면 글로벌 로그로 로깅</li>
	<li>Log.debug(log, isGlobal);<br>
	 -> 로깅. isGlobal가 참이면 글로벌 로그로 로깅</li>
	<li>Log.error(log, isGlobal, hideToast);<br>
	 -> 로깅. isGlobal가 참이면 글로벌 로그로 로깅, hideToast가 true이면 토스트 출력 안함</li>
	<li>Log.i();<br>
	 -> Log.info();와 동일</li>
	<li>Log.d();<br>
	 -> Log.debug();와 동일</li>
	<li>Log.e();<br>
	 -> Log.error();와 동일</li>
	</ul>
	
	<b><big>Bridge</big>
	<ul></b>
	<li>Bridge.isAllowed(botName);<br>
	 -> 해당 봇에 Bridge를 통해 접근할 수 있는지 확인</li>
	<li>Bridge.getScopeOf(botName);<br>
	 -> 해당 봇의 전역 스코프를 가지고 옴</li>
	<li>Bridge.evaluateStringIn(botName, source);<br>
	 -> 해당 이름을 가진 봇에서 eval 실행.</li>
	<li>Bridge.getVariable(room, name);<br>
	 -> 단순 자동응답 기능에 있는 변수의 값을 가지고 옴.</li>
	<li>Bridge.setVariable(room, name, value);<br>
	 -> 단순 자동응답 기능에 있는 변수의 값을 value로 설정.</li>
	<li>Bridge.getGlobalVariable(name);<br>
	 -> 단순 자동응답 기능에 있는 전체변수의 값을 가지고 옴.</li>
	<li>Bridge.setGlobalVariable(name, value);<br>
	 -> 단순 자동응답 기능에 있는 전체변수의 값을 value로 설정.</li>
	</ul>
	
    </font>
</div>
<hr>
<font color=BLACK size='2sp'>
    <p align=center>© 2018-2020 Dark Tornado, All rights reserved.</p>
</font>
</body>
</html>

